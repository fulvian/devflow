/**
 * DevFlow Cognitive Mapping Engine - Phase 2
 * 
 * This module integrates all cognitive mapping components:
 * - Mental Map Construction from codebase AST analysis
 * - Navigation Engine with human-like exploration patterns  
 * - PageRank importance calculation for landmark nodes
 * - Neo4j graph database integration
 * - Activity Registry System for development pattern tracking
 */

// Core Types and Interfaces
export * from './types';

// Database Adapter
export { Neo4jCognitiveAdapter } from './neo4j-adapter';

// Mental Map Construction
export { 
  MentalMapConstructor, 
  VectorSimilarityEngine, 
  ASTParser, 
  WorkingMemoryCache 
} from './mental-map-constructor';

// Navigation Engine  
export { NavigationEngine } from './navigation-engine';

// PageRank Engine
export { PageRankEngine, PageRankConfig, NodeImportance, PageRankResult } from './pagerank-engine';

/**
 * Main Cognitive Mapping System orchestrator
 */
export class CognitiveMappingSystem {
  private neo4jAdapter: Neo4jCognitiveAdapter;
  private mentalMapConstructor: MentalMapConstructor;
  private navigationEngine: NavigationEngine;
  private pageRankEngine: PageRankEngine;

  constructor(
    neo4jConfig: { uri: string; username: string; password: string; database?: string }
  ) {
    // Initialize components
    this.neo4jAdapter = new Neo4jCognitiveAdapter(neo4jConfig);
    
    const vectorEngine = new VectorSimilarityEngine();
    const astParser = new ASTParser();
    this.mentalMapConstructor = new MentalMapConstructor(vectorEngine, astParser);
    
    this.navigationEngine = new NavigationEngine();
    
    // Note: PageRankEngine would need proper dependencies in full implementation
    // this.pageRankEngine = new PageRankEngine(...);
  }

  /**
   * Initialize the cognitive mapping system
   */
  async initialize(): Promise<void> {
    await this.neo4jAdapter.connect();
    await this.neo4jAdapter.initializeSchema();
  }

  /**
   * Build cognitive map from source code
   * @param sourceCode - Source code to analyze
   * @param moduleId - Module identifier
   * @returns Constructed mental map
   */
  async buildCognitiveMap(sourceCode: string, moduleId: string) {
    return await this.mentalMapConstructor.constructMentalMap(sourceCode, moduleId);
  }

  /**
   * Navigate through cognitive map
   * @param mentalMap - Mental map to navigate
   * @param startNodeId - Starting node
   * @param context - Navigation context
   * @returns Navigation path
   */
  async navigateMap(mentalMap: any, startNodeId: string, context: any) {
    return await this.navigationEngine.associativeTraversal(mentalMap, startNodeId, context);
  }

  /**
   * Shutdown system and close connections
   */
  async shutdown(): Promise<void> {
    await this.neo4jAdapter.disconnect();
  }
}